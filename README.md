
# Тестовое задание для собеседования в компанию 
***


#####  В задании используется ряд иструменнов с открытым исходным кодом :

- [GitHub](https://github.com/olejean/devops-diplom) - GitHub — крупнейший веб-сервис для хостинга IT-проектов и их совместной разработки.
- [Docker](https://www.docker.com/) - Платформа контейнеризации 
- [Docker-compose](https://www.docker.com/) - Надстройка над docker  для запуска множества контейнеров
***
## Задание 

Тестовое задание:

Есть несколько (N) nginx в режиме обратного прокси (proxy_pass...).
За ними приложение, отвечающее по HTTP.
Запрос от пользователя может прийти на любой из nginx!
Запрос от пользователя может пройти как через один nginх, так и по цепочке через
несколько nginx.
Примеры:

пользователь>nginx1>приложение
пользователь>nginx2>приложение
...
пользователь>nginxN>приложение
пользователь>nginx1>nginx2>nginxN>приложение
пользователь>nginx2>nginxN>приложение

Приложение проверяет заголовок X-Forwarded-For.
Требуется, чтобы приложение в заголовке получило IP адрес пользователя и всех nginx
(всю цепочку), через которые прошел запрос.
Требуется, чтобы приложение не получило заголовок X-Forwarded-For, который
недобросовестный пользователь может добавить в свой запрос.

Решение необходимо подготовить в виде тестового стенда для запуска в docker-compose, минимум из
трех серверов nginx и любого готового или своего приложения, выводящего заголовок
X-Forwarded-For.

Предоставьте протокол тестирования на выполнение всех требований задания с
помощью утилиты curl.


***
## Решение


- Балансировщик нагрузки: Контейнер load_balancer распределяет запросы по круговой схеме (round robin) между nginx1, nginx2, и nginx3.

конфигурации nginx1.conf nginx2.conf nginx3.conf Настроены на проксирование по цепочке и напрямую в приложение. 
nginx1 > nginx2 > app
nginx2 > nginx3 > app
nginx3 > app
- В зависимоти на какой nginx  передаст запрос балансировщик нагрузки, по тому пути и пойдет.

- Конфигурации nginx1, nginx2, nginx3: Каждый nginx сервер удаляет пользовательский заголовок X-Forwarded-For и добавляет свой заголовок перед проксированием на следующий сервер.
- Эти настройки обеспечат балансировку нагрузки, последовательное проксирование запросов через цепочку nginx серверов к приложению, и корректное управление заголовком X-Forwarded-For.

- в качестве приложения возвращающего X-Forwarded-For - был выбран  фрейморк Flask


### Результаты тестирования testing_protokol.txt
HTTP/1.1 200 OK
Server: nginx/1.27.0
Date: Tue, 09 Jul 2024 10:16:52 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 64
Connection: keep-alive

X-Forwarded-For: 172.19.0.1, 172.19.0.4, 172.19.0.2, 172.19.0.6

----


HTTP/1.1 200 OK
Server: nginx/1.27.0
Date: Tue, 09 Jul 2024 10:17:15 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 52
Connection: keep-alive

X-Forwarded-For: 172.19.0.1, 172.19.0.4, 172.19.0.6

-----
HTTP/1.1 200 OK
Server: nginx/1.27.0
Date: Tue, 09 Jul 2024 10:17:31 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 40
Connection: keep-alive

X-Forwarded-For: 172.19.0.1, 172.19.0.4

----

HTTP/1.1 200 OK
Server: nginx/1.27.0
Date: Tue, 09 Jul 2024 10:17:53 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 64
Connection: keep-alive

X-Forwarded-For: 172.19.0.1, 172.19.0.4, 172.19.0.2, 172.19.0.6










 






